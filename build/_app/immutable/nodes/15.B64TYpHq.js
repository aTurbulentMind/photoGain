import{C as he,A as e,z as l,a as w,t as C,F as ze,B as r,D as te}from"../chunks/disclose-version.mX-FAZ6T.js";import{e as $e,H as Le,R as ae,J as Oe,h as a,t as ve,$ as qe,a0 as _,f as W,T as I,A as Re}from"../chunks/runtime.Cd5kR4Mq.js";import{s as He}from"../chunks/render.NljB-ERN.js";import{i as pe}from"../chunks/if.B3c3E52T.js";import{e as we,i as Je}from"../chunks/each.DmgNhpkJ.js";import{a as Se,e as Ne}from"../chunks/forms.BbLM5WEZ.js";import{r as v,s as Ve}from"../chunks/attributes.CjHmVdtE.js";import{e as de}from"../chunks/svelte-head.w8Cc7TMq.js";import{l as Ke,a as re,c as m}from"../chunks/input.Bm04sMYF.js";import{i as Qe}from"../chunks/proxy.DCTM8AMB.js";import{i as Ue}from"../chunks/lifecycle.bPVENhTh.js";import{p as We}from"../chunks/props.BmNrInug.js";function ke(o,b,p){if(o.multiple)return Ye(o,b);for(var f of o.options){var d=X(f);if(Qe(d,b)){f.selected=!0;return}}(!p||b!==void 0)&&(o.selectedIndex=-1)}function Xe(o,b){$e(()=>{var p=new MutationObserver(()=>{var f=o.__value;ke(o,f)});return p.observe(o,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{p.disconnect()}})}function Te(o,b,p){var f=!0;Ke(o,"change",()=>{var d;if(o.multiple)d=[].map.call(o.querySelectorAll(":checked"),X);else{var D=o.querySelector(":checked");d=D&&X(D)}p(d)}),$e(()=>{var d=b();if(ke(o,d,f),f&&d===void 0){var D=o.querySelector(":checked");D!==null&&(d=X(D),p(d))}o.__value=d,f=!1}),Xe(o)}function Ye(o,b){for(var p of o.options)p.selected=~b.indexOf(X(p))}function X(o){return"__value"in o?o.__value:o.value}var Ze=C('<form method="post" action="?/submit" enctype="multipart/form-data"><input type="hidden" name="operation" value="new"> <label>Type of text: <br> <label><input type="radio" name="type_of_text"> Blog</label> <label><input type="radio" name="type_of_text"> Gallery</label></label> <br> <label>Images: <input type="file" name="images" id="image-upload" multiple></label> <br> <label>Date Made: <input type="date" name="date_made" required></label> <br> <label>Text Name: <input type="text" name="text_name" placeholder="Name of text" required></label> <br> <label>Author: <input type="text" name="author" placeholder="Name of author" required></label> <br> <label>Categories: <input type="text" name="categories" placeholder="Categories" required></label> <br> <label>Status: <input type="text" name="status" placeholder="Status" required></label> <br> <label>Text: <input type="text" name="text_guts" placeholder="Text guts" required></label> <br> <button type="submit">Submit</button></form>'),et=C("<option> </option>"),tt=C('<div><img alt="Vaporwave" class="svelte-w2y9nv"> <button type="button">Delete</button></div>'),at=C("<div></div>"),rt=C("<p>No images found for this post.</p>"),lt=C('<form method="post" action="?/submit"><input type="hidden" name="operation" value="modify"> <select name="id"><option>-- select a post --</option><!></select> <br> <!> <label>Type of text: <br> <label><input type="radio" name="type_of_text"> Blog</label> <br> <label><input type="radio" name="type_of_text"> Gallery</label></label> <br> <label>Date Made: <input type="date" name="date_made" required></label> <label><br> Text Name: <input type="text" name="text_name" placeholder="Name of text" required></label> <label>Author: <input type="text" name="author" placeholder="Name of author" required></label> <label>Categories: <input type="text" name="categories" placeholder="Categories" required></label> <label>Status: <input type="text" name="status" placeholder="Status" required></label> <label>Text: <input type="text" name="text_guts" placeholder="Text guts" required></label> <br> <div class="window-content"><button class="win_95_butt" type="submit">Submit</button></div></form>'),ot=C('<br> <br> <br> <div class="win_95"><select><option>-- select an operation --</option><option>New Post</option><option>Modify Existing</option></select> <!></div>',1);function xt(o,b){Le(b,!1);const p=[];let f=We(b,"data"),{existingPosts:d,session:D,supabase:me,profile:it}=f(),G=ve([]),t=ve({id:"",date_made:"",text_name:"",author:"",categories:"",status:"",text_guts:"",type_of_text:"",images:[]}),z=ve("");async function Ae(){const n=d.find(s=>s.id===a(t).id);if(n){W(t,{...a(t),date_made:n.date_made,text_name:n.text_name,author:n.author,categories:n.categories,status:n.status,text_guts:n.text_guts,type_of_text:n.type_of_text.toString()});const{data:s,error:x}=await me.storage.from("Gallery").list(`${a(t).text_name}/`,{limit:100});if(x){console.error("Error fetching images:",x.message);return}s&&s.length>0?W(G,s.map((y,q)=>{const S=`https://auiqlbvzsvvsjvpijukm.supabase.co/storage/v1/object/public/Gallery/${a(t).text_name}/${y.name}`;return{id:q,url:S}})):W(G,[])}else console.error("Selected post not found")}async function Ce(n){const s=n.split("/").pop(),{error:x}=await me.storage.from("Gallery").remove([`${a(t).text_name}/${s}`]);x?console.error("Error deleting image:",x.message):(W(G,a(G).filter(y=>y.url!==n)),console.log(`Successfully deleted ${s}`))}function De(n){_(t,a(t).images=Array.from(n.target.files))}Ue();var be=ot(),Ge=he(be),Ee=e(e(Ge,!0)),Me=e(e(Ee,!0)),fe=e(e(Me,!0)),Y=l(fe);ae(()=>{a(z),qe(()=>{})});var le=l(Y);le.value=((le.__value="")==null,"");var oe=e(le);oe.value=(oe.__value="new")==null?"":"new";var ce=e(oe);ce.value=(ce.__value="modify")==null?"":"modify",r(Y);var Pe=e(e(Y,!0));pe(Pe,()=>a(z)==="new",n=>{var s=Ze(),x=l(s),y=e(e(x,!0)),q=e(l(y)),S=e(e(q,!0)),c=l(S);v(c),c.value=(c.__value="1")==null?"":"1",te(),r(S);var E=e(e(S,!0)),M=l(E);v(M),M.value=(M.__value="2")==null?"":"2",te(),r(E),r(y);var ie=e(e(y,!0)),P=e(e(ie,!0)),L=e(l(P));r(P);var ue=e(e(P,!0)),N=e(e(ue,!0)),T=e(l(N));v(T),r(N);var ne=e(e(N,!0)),j=e(e(ne,!0)),$=e(l(j));v($),r(j);var _e=e(e(j,!0)),k=e(e(_e,!0)),O=e(l(k));v(O),r(k);var R=e(e(k,!0)),H=e(e(R,!0)),J=e(l(H));v(J),r(H);var V=e(e(H,!0)),B=e(e(V,!0)),F=e(l(B));v(F),r(B);var Z=e(e(B,!0)),A=e(e(Z,!0)),K=e(l(A));v(K),r(A);var Q=e(e(A,!0));e(e(Q,!0)),r(s),Se(s,u=>Ne(u)),re(p,[],c,()=>a(t).type_of_text,u=>_(t,a(t).type_of_text=u)),re(p,[],M,()=>a(t).type_of_text,u=>_(t,a(t).type_of_text=u)),de("change",L,De,!1),m(T,()=>a(t).date_made,u=>_(t,a(t).date_made=u)),m($,()=>a(t).text_name,u=>_(t,a(t).text_name=u)),m(O,()=>a(t).author,u=>_(t,a(t).author=u)),m(J,()=>a(t).categories,u=>_(t,a(t).categories=u)),m(F,()=>a(t).status,u=>_(t,a(t).status=u)),m(K,()=>a(t).text_guts,u=>_(t,a(t).text_guts=u)),w(n,s)},n=>{var s=ze(),x=he(s);pe(x,()=>a(z)==="modify",y=>{var q=lt(),S=l(q),c=e(e(S,!0));ae(()=>{a(t).id,qe(()=>{})});var E=l(c);E.value=((E.__value="")==null,"");var M=e(E);we(M,1,()=>d,Je,(i,g,ee)=>{var h=et(),se={},U=l(h);r(h),ae(()=>{se!==(se=I(g).id)&&(h.value=(h.__value=I(g).id)==null?"":I(g).id),He(U,I(g).text_name)}),w(i,h)}),r(c);var ie=e(e(c,!0)),P=e(e(ie,!0));pe(P,()=>a(G).length>0,i=>{var g=at();we(g,15,()=>a(G),(ee,h)=>ee.id,(ee,h,se)=>{var U=tt(),xe=l(U),Be=e(e(xe,!0)),Fe=Re(()=>()=>Ce(I(h).url));r(U),ae(()=>Ve(xe,"src",I(h).url)),de("click",Be,function(...Ie){var ye;return(ye=a(Fe))==null?void 0:ye.apply(this,Ie)},!1),w(ee,U)}),r(g),w(i,g)},i=>{var g=rt();w(i,g)});var L=e(e(P,!0)),ue=e(l(L)),N=e(e(ue,!0)),T=l(N);v(T),T.value=(T.__value="1")==null?"":"1",te(),r(N);var ne=e(e(N,!0)),j=e(e(ne,!0)),$=l(j);v($),$.value=($.__value="2")==null?"":"2",te(),r(j),r(L);var _e=e(e(L,!0)),k=e(e(_e,!0)),O=e(l(k));v(O),r(k);var R=e(e(k,!0)),H=l(R),J=e(e(H,!0));v(J),r(R);var V=e(e(R,!0)),B=e(l(V));v(B),r(V);var F=e(e(V,!0)),Z=e(l(F));v(Z),r(F);var A=e(e(F,!0)),K=e(l(A));v(K),r(A);var Q=e(e(A,!0)),u=e(l(Q));v(u),r(Q);var je=e(e(Q,!0)),ge=e(e(je,!0));l(ge),r(ge),r(q),Se(q,i=>Ne(i)),Te(c,()=>a(t).id,i=>_(t,a(t).id=i)),de("change",c,Ae,!1),re(p,[],T,()=>a(t).type_of_text,i=>_(t,a(t).type_of_text=i)),re(p,[],$,()=>a(t).type_of_text,i=>_(t,a(t).type_of_text=i)),m(O,()=>a(t).date_made,i=>_(t,a(t).date_made=i)),m(J,()=>a(t).text_name,i=>_(t,a(t).text_name=i)),m(B,()=>a(t).author,i=>_(t,a(t).author=i)),m(Z,()=>a(t).categories,i=>_(t,a(t).categories=i)),m(K,()=>a(t).status,i=>_(t,a(t).status=i)),m(u,()=>a(t).text_guts,i=>_(t,a(t).text_guts=i)),w(y,q)},null,!0),w(n,s)}),r(fe),Te(Y,()=>a(z),n=>W(z,n)),w(o,be),Oe()}export{xt as component};
