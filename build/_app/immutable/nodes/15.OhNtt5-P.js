import{C as fe,s as e,c as i,a as T,t as L,F as Ee,r,D as Q}from"../chunks/disclose-version.R2tMHkCf.js";import{e as he,p as Ge,t as U,a as Le,g as a,m as re,$ as be,a0 as s,s as R,T as A,D as Me}from"../chunks/runtime.B9Tkknyz.js";import{s as Pe}from"../chunks/render.BR1jdBP3.js";import{i as le}from"../chunks/if.Gr1yDK32.js";import{e as ce,i as je}from"../chunks/each.Cteka9H4.js";import{a as ge,e as xe}from"../chunks/forms.D9FfQH4M.js";import{r as p,a as Ae}from"../chunks/attributes.BCpl9MSX.js";import{e as oe}from"../chunks/svelte-head.C8vKO2zP.js";import{l as Ie,a as W,c as f,b as Oe}from"../chunks/input.O5HQZv8O.js";import{i as Be}from"../chunks/proxy.00HlNIsX.js";import{i as Fe}from"../chunks/lifecycle.KSb5esXj.js";import{p as ze}from"../chunks/props.UsdjHU8F.js";import{s as ie}from"../chunks/supabaseClient.DYmWHwRN.js";function qe(l,b,v){if(l.multiple)return Re(l,b);for(var c of l.options){var m=V(c);if(Be(m,b)){c.selected=!0;return}}(!v||b!==void 0)&&(l.selectedIndex=-1)}function He(l,b){he(()=>{var v=new MutationObserver(()=>{var c=l.__value;qe(l,c)});return v.observe(l,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{v.disconnect()}})}function ye(l,b,v){var c=!0;Ie(l,"change",()=>{var m;if(l.multiple)m=[].map.call(l.querySelectorAll(":checked"),V);else{var d=l.querySelector(":checked");m=d&&V(d)}v(m)}),he(()=>{var m=b();if(qe(l,m,c),c&&m===void 0){var d=l.querySelector(":checked");d!==null&&(m=V(d),v(m))}l.__value=m,c=!1}),He(l)}function Re(l,b){for(var v of l.options)v.selected=~b.indexOf(V(v))}function V(l){return"__value"in l?l.__value:l.value}var Ve=L('<form method="post" action="?/submit" enctype="multipart/form-data"><input type="hidden" name="operation" value="new"> <label>Type of text: <label><input type="radio" name="type_of_text"> Blog</label> <label><input type="radio" name="type_of_text"> Gallery</label></label> <label>Images: <input type="file" name="images" id="image-upload" multiple></label> <label>Date Made: <input type="date" name="date_made" required></label> <label>Text Name: <input type="text" name="text_name" placeholder="Name of text" required></label> <label>Author: <input type="text" name="author" placeholder="Name of author" required></label> <label>Categories: <input type="text" name="categories" placeholder="Categories" required></label> <label>Status: <input type="text" name="status" placeholder="Status" required></label> <label>Text: <input type="text" name="text_guts" placeholder="Text guts" required></label> <button type="submit">Submit</button></form>'),Je=L("<option> </option>"),Ke=L('<div><img alt="Vaporwave" class="svelte-w2y9nv"> <button type="button">Delete</button></div>'),Qe=L("<div></div>"),Ue=L("<p>No images found for this post.</p>"),We=L('<form method="post" action="?/submit"><input type="hidden" name="operation" value="modify"> <select name="id"><option>-- select a post --</option><!></select> <br> <!> <label>Type of text: <label><input type="radio" name="type_of_text"> Blog</label> <label><input type="radio" name="type_of_text"> Gallery</label></label> <label>Date Made: <input type="date" name="date_made" required></label> <label>Text Name: <input type="text" name="text_name" placeholder="Name of text" required></label> <label>Author: <input type="text" name="author" placeholder="Name of author" required></label> <label>Categories: <input type="text" name="categories" placeholder="Categories" required></label> <label>Status: <input type="text" name="status" placeholder="Status" required></label> <label>Text: <input type="text" name="text_guts" placeholder="Text guts" required></label> <button type="submit">Submit</button></form>'),Xe=L("<h1>Hello friend.</h1> <select><option>-- select an operation --</option><option>New Post</option><option>Modify Existing</option></select> <!> <button>Logout</button>",1);function pt(l,b){Ge(b,!1);const v=[];let c=ze(b,"data"),{existingPosts:m}=c(),d=re([]),t=re({id:"",date_made:"",text_name:"",author:"",categories:"",status:"",text_guts:"",type_of_text:"",images:[]}),I=re("");async function Se(){const n=m.find(_=>_.id===a(t).id);if(n){R(t,{...a(t),date_made:n.date_made,text_name:n.text_name,author:n.author,categories:n.categories,status:n.status,text_guts:n.text_guts,type_of_text:n.type_of_text.toString()});const{data:_,error:y}=await ie.storage.from("Gallery").list(`${a(t).text_name}/`,{limit:100});if(y){console.error("Error fetching images:",y.message);return}_&&_.length>0?R(d,_.map((h,g)=>{const S=`https://auiqlbvzsvvsjvpijukm.supabase.co/storage/v1/object/public/Gallery/${a(t).text_name}/${h.name}`;return{id:g,url:S}})):R(d,[])}}async function we(n){const _=n.split("/").pop(),{error:y}=await ie.storage.from("Gallery").remove([`${a(t).text_name}/${_}`]);y?console.error("Error deleting image:",y.message):(R(d,a(d).filter(h=>h.url!==n)),console.log(`Successfully deleted ${_}`))}async function Ne(){const{error:n}=await ie.auth.signOut();n?console.error("Error logging out:",n.message):console.log("Successfully logged out")}Fe();var ue=Xe(),Te=fe(ue),J=e(e(Te,!0));U(()=>{a(I),be(()=>{})});var X=i(J);X.value=((X.__value="")==null,"");var Y=e(X);Y.value=(Y.__value="new")==null?"":"new";var ne=e(Y);ne.value=(ne.__value="modify")==null?"":"modify",r(J);var se=e(e(J,!0));le(se,()=>a(I)==="new",n=>{var _=Ve(),y=i(_),h=e(e(y,!0)),g=e(i(h)),S=i(g);p(S),S.value=(S.__value="1")==null?"":"1",Q(),r(g);var w=e(e(g,!0)),N=i(w);p(N),N.value=(N.__value="2")==null?"":"2",Q(),r(w),r(h);var O=e(e(h,!0)),Z=e(i(O));r(O);var M=e(e(O,!0)),P=e(i(M));p(P),r(M);var k=e(e(M,!0)),$=e(i(k));p($),r(k);var j=e(e(k,!0)),D=e(i(j));p(D),r(j);var C=e(e(j,!0)),B=e(i(C));p(B),r(C);var E=e(e(C,!0)),F=e(i(E));p(F),r(E);var G=e(e(E,!0)),z=e(i(G));p(z),r(G),e(e(G,!0)),r(_),ge(_,u=>xe(u)),W(v,[],S,()=>a(t).type_of_text,u=>s(t,a(t).type_of_text=u)),W(v,[],N,()=>a(t).type_of_text,u=>s(t,a(t).type_of_text=u)),Oe(Z,()=>a(t).images,u=>s(t,a(t).images=u)),f(P,()=>a(t).date_made,u=>s(t,a(t).date_made=u)),f($,()=>a(t).text_name,u=>s(t,a(t).text_name=u)),f(D,()=>a(t).author,u=>s(t,a(t).author=u)),f(B,()=>a(t).categories,u=>s(t,a(t).categories=u)),f(F,()=>a(t).status,u=>s(t,a(t).status=u)),f(z,()=>a(t).text_guts,u=>s(t,a(t).text_guts=u)),T(n,_)},n=>{var _=Ee(),y=fe(_);le(y,()=>a(I)==="modify",h=>{var g=We(),S=i(g),w=e(e(S,!0));U(()=>{a(t).id,be(()=>{})});var N=i(w);N.value=((N.__value="")==null,"");var O=e(N);ce(O,1,()=>m,je,(o,x,K)=>{var q=Je(),ae={},H=i(q);r(q),U(()=>{ae!==(ae=A(x).id)&&(q.value=(q.__value=A(x).id)==null?"":A(x).id),Pe(H,A(x).text_name)}),T(o,q)}),r(w);var Z=e(e(w,!0)),M=e(e(Z,!0));le(M,()=>a(d).length>0,o=>{var x=Qe();ce(x,15,()=>a(d),(K,q)=>K.id,(K,q,ae)=>{var H=Ke(),me=i(H),$e=e(e(me,!0)),De=Me(()=>()=>we(A(q).url));r(H),U(()=>Ae(me,"src",A(q).url)),oe("click",$e,function(...Ce){var de;return(de=a(De))==null?void 0:de.apply(this,Ce)},!1),T(K,H)}),r(x),T(o,x)},o=>{var x=Ue();T(o,x)});var P=e(e(M,!0)),k=e(i(P)),$=i(k);p($),$.value=($.__value="1")==null?"":"1",Q(),r(k);var j=e(e(k,!0)),D=i(j);p(D),D.value=(D.__value="2")==null?"":"2",Q(),r(j),r(P);var C=e(e(P,!0)),B=e(i(C));p(B),r(C);var E=e(e(C,!0)),F=e(i(E));p(F),r(E);var G=e(e(E,!0)),z=e(i(G));p(z),r(G);var u=e(e(G,!0)),_e=e(i(u));p(_e),r(u);var ee=e(e(u,!0)),pe=e(i(ee));p(pe),r(ee);var te=e(e(ee,!0)),ve=e(i(te));p(ve),r(te),e(e(te,!0)),r(g),ge(g,o=>xe(o)),ye(w,()=>a(t).id,o=>s(t,a(t).id=o)),oe("change",w,Se,!1),W(v,[],$,()=>a(t).type_of_text,o=>s(t,a(t).type_of_text=o)),W(v,[],D,()=>a(t).type_of_text,o=>s(t,a(t).type_of_text=o)),f(B,()=>a(t).date_made,o=>s(t,a(t).date_made=o)),f(F,()=>a(t).text_name,o=>s(t,a(t).text_name=o)),f(z,()=>a(t).author,o=>s(t,a(t).author=o)),f(_e,()=>a(t).categories,o=>s(t,a(t).categories=o)),f(pe,()=>a(t).status,o=>s(t,a(t).status=o)),f(ve,()=>a(t).text_guts,o=>s(t,a(t).text_guts=o)),T(h,g)},null,!0),T(n,_)});var ke=e(e(se,!0));ye(J,()=>a(I),n=>R(I,n)),oe("click",ke,Ne,!1),T(l,ue),Le()}export{pt as component};
