import{C as ge,s as e,c as u,a as T,t as M,F as Me,r,D as X}from"../chunks/disclose-version.R2tMHkCf.js";import{e as we,p as Oe,m as I,U as Pe,V as je,t as Y,a as Ae,g as a,$ as xe,a0 as s,s as k,O as Ie,T as B,D as Be}from"../chunks/runtime.B9Tkknyz.js";import{s as Fe}from"../chunks/render.BR1jdBP3.js";import{i as ie}from"../chunks/if.Gr1yDK32.js";import{e as ye,i as Ve}from"../chunks/each.Cteka9H4.js";import{a as he,e as qe}from"../chunks/forms.BB8YNtgd.js";import{r as p,a as ze}from"../chunks/attributes.BCpl9MSX.js";import{e as ue}from"../chunks/svelte-head.C8vKO2zP.js";import{l as He,a as Z,c as f,b as Re}from"../chunks/input.O5HQZv8O.js";import{i as Ue}from"../chunks/proxy.00HlNIsX.js";import{i as Je}from"../chunks/lifecycle.KSb5esXj.js";import{p as Ke}from"../chunks/props.UsdjHU8F.js";function Ne(l,b,v){if(l.multiple)return We(l,b);for(var d of l.options){var m=K(d);if(Ue(m,b)){d.selected=!0;return}}(!v||b!==void 0)&&(l.selectedIndex=-1)}function Qe(l,b){we(()=>{var v=new MutationObserver(()=>{var d=l.__value;Ne(l,d)});return v.observe(l,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{v.disconnect()}})}function Se(l,b,v){var d=!0;He(l,"change",()=>{var m;if(l.multiple)m=[].map.call(l.querySelectorAll(":checked"),K);else{var x=l.querySelector(":checked");m=x&&K(x)}v(m)}),we(()=>{var m=b();if(Ne(l,m,d),d&&m===void 0){var x=l.querySelector(":checked");x!==null&&(m=K(x),v(m))}l.__value=m,d=!1}),Qe(l)}function We(l,b){for(var v of l.options)v.selected=~b.indexOf(K(v))}function K(l){return"__value"in l?l.__value:l.value}var Xe=M('<form method="post" action="?/submit" enctype="multipart/form-data"><input type="hidden" name="operation" value="new"> <label>Type of text: <label><input type="radio" name="type_of_text"> Blog</label> <label><input type="radio" name="type_of_text"> Gallery</label></label> <label>Images: <input type="file" name="images" id="image-upload" multiple></label> <label>Date Made: <input type="date" name="date_made" required></label> <label>Text Name: <input type="text" name="text_name" placeholder="Name of text" required></label> <label>Author: <input type="text" name="author" placeholder="Name of author" required></label> <label>Categories: <input type="text" name="categories" placeholder="Categories" required></label> <label>Status: <input type="text" name="status" placeholder="Status" required></label> <label>Text: <input type="text" name="text_guts" placeholder="Text guts" required></label> <button type="submit">Submit</button></form>'),Ye=M("<option> </option>"),Ze=M('<div><img alt="Vaporwave" class="svelte-w2y9nv"> <button type="button">Delete</button></div>'),et=M("<div></div>"),tt=M("<p>No images found for this post.</p>"),at=M('<form method="post" action="?/submit"><input type="hidden" name="operation" value="modify"> <select name="id"><option>-- select a post --</option><!></select> <br> <!> <label>Type of text: <label><input type="radio" name="type_of_text"> Blog</label> <label><input type="radio" name="type_of_text"> Gallery</label></label> <label>Date Made: <input type="date" name="date_made" required></label> <label>Text Name: <input type="text" name="text_name" placeholder="Name of text" required></label> <label>Author: <input type="text" name="author" placeholder="Name of author" required></label> <label>Categories: <input type="text" name="categories" placeholder="Categories" required></label> <label>Status: <input type="text" name="status" placeholder="Status" required></label> <label>Text: <input type="text" name="text_guts" placeholder="Text guts" required></label> <button type="submit">Submit</button></form>'),rt=M("<h1>Hello friend.</h1> <select><option>-- select an operation --</option><option>New Post</option><option>Modify Existing</option></select> <!> <button>Logout</button>",1);function bt(l,b){Oe(b,!1);const v=[];let d=Ke(b,"data"),{existingPosts:m}=d(),x=d(),ne=I(x.session),F=I(x.supabase),se=I(x.profile),O=I([]),t=I({id:"",date_made:"",text_name:"",author:"",categories:"",status:"",text_guts:"",type_of_text:"",images:[]}),V=I("");async function Te(){const o=m.find(_=>_.id===a(t).id);if(o){k(t,{...a(t),date_made:o.date_made,text_name:o.text_name,author:o.author,categories:o.categories,status:o.status,text_guts:o.text_guts,type_of_text:o.type_of_text.toString()});const{data:_,error:y}=await a(F).storage.from("Gallery").list(`${a(t).text_name}/`,{limit:100});if(y){console.error("Error fetching images:",y.message);return}_&&_.length>0?k(O,_.map((h,c)=>{const S=`https://auiqlbvzsvvsjvpijukm.supabase.co/storage/v1/object/public/Gallery/${a(t).text_name}/${h.name}`;return{id:c,url:S}})):k(O,[])}}async function ke(o){const _=o.split("/").pop(),{error:y}=await a(F).storage.from("Gallery").remove([`${a(t).text_name}/${_}`]);y?console.error("Error deleting image:",y.message):(k(O,a(O).filter(h=>h.url!==o)),console.log(`Successfully deleted ${_}`))}async function $e(){const{error:o}=await a(F).auth.signOut();o?console.error("Error logging out:",o.message):console.log("Successfully logged out")}Pe(()=>(a(ne),a(F),a(se),Ie(d())),()=>{(()=>{const o=d();return k(ne,o.session),k(F,o.supabase),k(se,o.profile),o})()}),je(),Je();var _e=rt(),De=ge(_e),Q=e(e(De,!0));Y(()=>{a(V),xe(()=>{})});var ee=u(Q);ee.value=((ee.__value="")==null,"");var te=e(ee);te.value=(te.__value="new")==null?"":"new";var pe=e(te);pe.value=(pe.__value="modify")==null?"":"modify",r(Q);var ve=e(e(Q,!0));ie(ve,()=>a(V)==="new",o=>{var _=Xe(),y=u(_),h=e(e(y,!0)),c=e(u(h)),S=u(c);p(S),S.value=(S.__value="1")==null?"":"1",X(),r(c);var w=e(e(c,!0)),N=u(w);p(N),N.value=(N.__value="2")==null?"":"2",X(),r(w),r(h);var z=e(e(h,!0)),ae=e(u(z));r(z);var P=e(e(z,!0)),j=e(u(P));p(j),r(P);var $=e(e(P,!0)),D=e(u($));p(D),r($);var A=e(e($,!0)),C=e(u(A));p(C),r(A);var E=e(e(A,!0)),H=e(u(E));p(H),r(E);var G=e(e(E,!0)),R=e(u(G));p(R),r(G);var L=e(e(G,!0)),U=e(u(L));p(U),r(L),e(e(L,!0)),r(_),he(_,n=>qe(n)),Z(v,[],S,()=>a(t).type_of_text,n=>s(t,a(t).type_of_text=n)),Z(v,[],N,()=>a(t).type_of_text,n=>s(t,a(t).type_of_text=n)),Re(ae,()=>a(t).images,n=>s(t,a(t).images=n)),f(j,()=>a(t).date_made,n=>s(t,a(t).date_made=n)),f(D,()=>a(t).text_name,n=>s(t,a(t).text_name=n)),f(C,()=>a(t).author,n=>s(t,a(t).author=n)),f(H,()=>a(t).categories,n=>s(t,a(t).categories=n)),f(R,()=>a(t).status,n=>s(t,a(t).status=n)),f(U,()=>a(t).text_guts,n=>s(t,a(t).text_guts=n)),T(o,_)},o=>{var _=Me(),y=ge(_);ie(y,()=>a(V)==="modify",h=>{var c=at(),S=u(c),w=e(e(S,!0));Y(()=>{a(t).id,xe(()=>{})});var N=u(w);N.value=((N.__value="")==null,"");var z=e(N);ye(z,1,()=>m,Ve,(i,g,W)=>{var q=Ye(),oe={},J=u(q);r(q),Y(()=>{oe!==(oe=B(g).id)&&(q.value=(q.__value=B(g).id)==null?"":B(g).id),Fe(J,B(g).text_name)}),T(i,q)}),r(w);var ae=e(e(w,!0)),P=e(e(ae,!0));ie(P,()=>a(O).length>0,i=>{var g=et();ye(g,15,()=>a(O),(W,q)=>W.id,(W,q,oe)=>{var J=Ze(),be=u(J),Ee=e(e(be,!0)),Ge=Be(()=>()=>ke(B(q).url));r(J),Y(()=>ze(be,"src",B(q).url)),ue("click",Ee,function(...Le){var ce;return(ce=a(Ge))==null?void 0:ce.apply(this,Le)},!1),T(W,J)}),r(g),T(i,g)},i=>{var g=tt();T(i,g)});var j=e(e(P,!0)),$=e(u(j)),D=u($);p(D),D.value=(D.__value="1")==null?"":"1",X(),r($);var A=e(e($,!0)),C=u(A);p(C),C.value=(C.__value="2")==null?"":"2",X(),r(A),r(j);var E=e(e(j,!0)),H=e(u(E));p(H),r(E);var G=e(e(E,!0)),R=e(u(G));p(R),r(G);var L=e(e(G,!0)),U=e(u(L));p(U),r(L);var n=e(e(L,!0)),me=e(u(n));p(me),r(n);var re=e(e(n,!0)),de=e(u(re));p(de),r(re);var le=e(e(re,!0)),fe=e(u(le));p(fe),r(le),e(e(le,!0)),r(c),he(c,i=>qe(i)),Se(w,()=>a(t).id,i=>s(t,a(t).id=i)),ue("change",w,Te,!1),Z(v,[],D,()=>a(t).type_of_text,i=>s(t,a(t).type_of_text=i)),Z(v,[],C,()=>a(t).type_of_text,i=>s(t,a(t).type_of_text=i)),f(H,()=>a(t).date_made,i=>s(t,a(t).date_made=i)),f(R,()=>a(t).text_name,i=>s(t,a(t).text_name=i)),f(U,()=>a(t).author,i=>s(t,a(t).author=i)),f(me,()=>a(t).categories,i=>s(t,a(t).categories=i)),f(de,()=>a(t).status,i=>s(t,a(t).status=i)),f(fe,()=>a(t).text_guts,i=>s(t,a(t).text_guts=i)),T(h,c)},null,!0),T(o,_)});var Ce=e(e(ve,!0));Se(Q,()=>a(V),o=>k(V,o)),ue("click",Ce,$e,!1),T(l,_e),Ae()}export{bt as component};
